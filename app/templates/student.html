<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Console</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body data-role="student">
  <header>
    <h1>Student Console</h1>
    <p>WebSocket: <span id="ws-status">connecting...</span></p>
  </header>

  <section class="panel">
    <h2>Firmware Upload (Arduino #2)</h2>
    <p>Current mode: <strong id="student-mode-view">unknown</strong></p>
    <p id="student-mode-note" class="muted"></p>
    <form id="firmware-form" class="grid">
      <label>Sketch (.ino or .zip)
        <input id="firmware-file" type="file" accept=".ino,.zip" />
      </label>
      <label>Board FQBN
        <input id="board-fqbn" type="text" value="arduino:avr:uno" />
      </label>
      <label>Sketch Main (optional)
        <input id="sketch-main" type="text" placeholder="main.ino" />
      </label>
      <button type="submit">Upload & Flash</button>
    </form>
    <pre id="firmware-status">waiting...</pre>
  </section>

  <section class="panel">
    <h2>Temperatures</h2>
    <div class="grid">
      <div><strong>T1:</strong> <span id="t1-value">n/a</span></div>
      <div><strong>T2:</strong> <span id="t2-value">n/a</span></div>
      <div><strong>T3:</strong> <span id="t3-value">n/a</span></div>
    </div>
  </section>

  <section class="panel">
    <h2>Telemetry Snapshot</h2>
    <div class="grid">
      <div><strong>P1:</strong> <span id="p1-value">n/a</span></div>
      <div><strong>P2:</strong> <span id="p2-value">n/a</span></div>
      <div><strong>Flow:</strong> <span id="flow-value">n/a</span></div>
      <div><strong>Heater:</strong> <span id="heater-value">n/a</span></div>
      <div><strong>Pump:</strong> <span id="pump-value">n/a</span></div>
      <div><strong>Fan:</strong> <span id="fan-value">n/a</span></div>
      <div><strong>Fault:</strong> <span id="fault-value">n/a</span></div>
      <div><strong>Drain:</strong> <span id="drain-valve-state">unknown</span></div>
    </div>
  </section>

  <section class="panel">
    <h2>Serial contract for student firmware (#2)</h2>
    <p>Baudrate: <strong>115200</strong></p>
    <p>JSON Lines: 1 JSON = 1 line + <code>\\n</code></p>
    <p>Send 5â€“10 Hz telemetry so the web UI can reflect pump/fans:</p>
    <pre>{"type":"telemetry","ver":"0.1","ts":...,"pump":120,"fan":[80,70,60]}</pre>
    <p class="muted">Optional fields: <code>fan_rpm</code>, <code>pump_rpm</code>.</p>
    <p class="muted">If teacher enables student firmware mode, web actuators are disabled and control is from the sketch.</p>
  </section>

  <section class="panel">
    <h2>Telemetry</h2>
    <pre id="telemetry">waiting...</pre>
  </section>

  <script src="/static/app.js"></script>
</body>
</html>
